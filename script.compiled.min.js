'use strict';var _createClass=function(){function c(d,e){for(var g,f=0;f<e.length;f++)g=e[f],g.enumerable=g.enumerable||!1,g.configurable=!0,'value'in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}return function(d,e,f){return e&&c(d.prototype,e),f&&c(d,f),d}}();function _classCallCheck(c,d){if(!(c instanceof d))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(c,d){if(!c)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return d&&('object'==typeof d||'function'==typeof d)?d:c}function _inherits(c,d){if('function'!=typeof d&&null!==d)throw new TypeError('Super expression must either be null or a function, not '+typeof d);c.prototype=Object.create(d&&d.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),d&&(Object.setPrototypeOf?Object.setPrototypeOf(c,d):c.__proto__=d)}function parseDate(c){var d=c,e=d.getDate(),f=d.getMonth()+1,h=d.getDay(),m=d.getFullYear();10>e&&(e='0'+e),10>f&&(f='0'+f);var n=e+'('+['\u0412\u0441','\u041F\u043D','\u0412\u0442','\u0421\u0440','\u0427\u0442','\u041F\u043D','\u0421\u0443'][h]+'.)';return n}function parseDateEU(c){var d=c.getDate(),e=c.getMonth()+1,f=c.getFullYear(),g=c.getDay();10>d&&(d='0'+d),10>e&&(e='0'+e);var m=d+'/'+e+'/'+f+' ('+['\u0412\u0441','\u041F\u043D','\u0412\u0442','\u0421\u0440','\u0427\u0442','\u041F\u043D','\u0421\u0443'][g]+')';return m}function getRandomInt(c){var d=Math.floor(Math.random()*Math.floor(c));return d+1}function getDaysInMonth(c,d){for(var e=new Date(d,c,1),f=[];e.getMonth()===c;)f.push(new Date(e)),e.setDate(e.getDate()+1);return f}var App=function(c){function d(e){_classCallCheck(this,d);var f=_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return f.selectedMonth=f.props.selectedMonth,f.selectedYear=f.props.selectedYear,f.state={screen:'Records'},f.changeScreenToRecords=f.changeScreenToRecords.bind(f),f.changeScreenToAdd=f.changeScreenToAdd.bind(f),f.changeScreenToConfirm=f.changeScreenToConfirm.bind(f),f.changeScreenToView=f.changeScreenToView.bind(f),f.updateRecords=f.updateRecords.bind(f),f}return _inherits(d,c),_createClass(d,[{key:'changeScreenToRecords',value:function changeScreenToRecords(){this.setState({screen:'Records'})}},{key:'changeScreenToConfirm',value:function changeScreenToConfirm(){this.setState({screen:'Confirm'})}},{key:'changeScreenToAdd',value:function changeScreenToAdd(){this.setState({screen:'Add'})}},{key:'changeScreenToView',value:function changeScreenToView(e){this.setState({screen:'View'}),this.viewData=e}},{key:'updateRecords',value:function updateRecords(e){e=JSON.parse(e),console.log(e),this.selectedMonth=e.month,this.selectedYear=e.year,this.setState({screen:'Records'})}},{key:'render',value:function render(){var e=DummyApi.getDataByMonth(this.selectedMonth,this.selectedYear);return'Records'==this.state.screen?React.createElement('div',null,React.createElement(Menu,{records:e,selectedMonth:this.selectedMonth,selectedYear:this.selectedYear,updateRecords:this.updateRecords,changeScreenToAdd:this.changeScreenToAdd}),React.createElement(Records,{records:e,changeScreenToView:this.changeScreenToView,changeScreenToConfirm:this.changeScreenToConfirm})):'Confirm'==this.state.screen?React.createElement('div',null,React.createElement(Confirm,{message:'\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B?',changeScreenToRecords:this.changeScreenToRecords})):'Add'==this.state.screen?React.createElement('div',null,React.createElement(Add,{changeScreenToRecords:this.changeScreenToRecords})):'View'==this.state.screen?React.createElement('div',null,React.createElement(View,{changeScreenToRecords:this.changeScreenToRecords,viewData:this.viewData})):void 0}}]),d}(React.Component),View=function(c){function d(e){return _classCallCheck(this,d),_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e))}return _inherits(d,c),_createClass(d,[{key:'render',value:function render(){for(var e=0,f=0,g=[],m=0;m<this.props.viewData.Туристы.length;m++){if(f+=this.props.viewData.Туристы[m].Нал,e+=this.props.viewData.Туристы[m].Количество,''!=this.props.viewData.Туристы[m].Фото)var h=React.createElement('div',{className:'four columns',style:{textAlign:'center'}},React.createElement('a',{href:this.props.viewData.Туристы[m].Фото,target:'_blank',rel:'noopener noreferrer'},React.createElement('img',{className:'u-max-full-width',height:'200px',src:this.props.viewData.Туристы[m].Фото})));else var h=React.createElement('div',{className:'four columns',style:{textAlign:'center'}},React.createElement('img',{className:'u-max-full-width',height:'200px',src:'img/noPhoto2.png'}));g[m]=React.createElement('div',{key:m,style:{padding:'20px 20px 10px 20px',borderBottom:'1px dotted black'}},React.createElement('div',{className:'row'},React.createElement('div',{className:'eight columns',style:{textAlign:'left'}},React.createElement('h6',null,React.createElement('b',null,this.props.viewData.Туристы[m].Количество),' \u0422\u0443\u0440., \u041E\u0442 ',React.createElement('b',null,this.props.viewData.Туристы[m].Откуда),', \u041E\u043F\u043B\u0430\u0442\u0438\u043B\u0438 \u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438: ',React.createElement('b',null,this.props.viewData.Туристы[m].Нал,' \u20AC'),React.createElement('br',null),React.createElement('br',null),React.createElement('b',null,'\u0414\u043E\u043F. \u0418\u043D\u0444\u043E:'),React.createElement('div',{style:{padding:'10px',color:'#888888'}},this.props.viewData.Туристы[m].ДопИнформация)),React.createElement('h5',null)),h))}return React.createElement('div',{className:'container'},React.createElement('div',{className:'row'},React.createElement('div',{className:'twelve columns',style:{textAlign:'center'}},React.createElement('br',null),React.createElement('h3',null,React.createElement('b',{style:{color:'green'}},this.props.viewData.Экскурсовод),' ',parseDateEU(this.props.viewData.Дата)),React.createElement('h4',null,React.createElement('b',{style:{color:'blue'}},e),' \u0422\u0443\u0440\u0438\u0441\u0442\u043E\u0432 ',React.createElement('b',{style:{color:'red'}},f,' \u20AC'),' \u041D\u0430\u043B\u0438\u0447\u043D\u044B\u043C\u0438'),React.createElement('button',{className:'button-primary',onClick:this.props.changeScreenToRecords},'\u0417\u0430\u043A\u0440\u044B\u0442\u044C'))),g,React.createElement('div',{'class':'row'},React.createElement('div',{className:'twelve columns'},React.createElement('img',{className:'u-full-width',src:this.props.viewData.Фото}))))}}]),d}(React.Component),Add=function(c){function d(e){_classCallCheck(this,d);var f=_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return f.addTour=f.addTour.bind(f),f.removeTour=f.removeTour.bind(f),f.state={numTour:0},f}return _inherits(d,c),_createClass(d,[{key:'removeTour',value:function removeTour(){this.setState({numTour:this.state.numTour-1})}},{key:'addTour',value:function addTour(){this.setState({numTour:this.state.numTour+1})}},{key:'render',value:function render(){for(var e=[],n=0;n<DummyApi.guideList.length;n++)e[n]=React.createElement('option',{key:n,value:n},DummyApi.guideList[n]);for(var f=[],g=DummyApi.last7Days(),o=0;o<g.length;o++)f[o]=React.createElement('option',{key:o,value:o},g[o]);for(var h=[],p=0;p<this.state.numTour;p++)h[p]=React.createElement(Tour,{key:p,listKey:p,removeTour:this.removeTour});for(var m=[],q=0;q<DummyApi.companyList.length;q++)m[q]=React.createElement('option',{key:q,value:q},DummyApi.companyList[q]);return React.createElement('div',{className:'container'},React.createElement('br',null),React.createElement('br',null),React.createElement('div',{className:'row'},React.createElement('div',{className:'six columns'},React.createElement('label',{htmlFor:'date'},'\u0414\u0430\u0442\u0430'),React.createElement('select',{className:'u-full-width',id:'date'},f)),React.createElement('div',{className:'six columns'},React.createElement('label',{htmlFor:'guides'},'\u042D\u043A\u0441\u043A\u0443\u0440\u0441\u043E\u0432\u043E\u0434'),React.createElement('select',{className:'u-full-width',id:'guides'},e))),React.createElement('div',{style:{backgroundColor:'#dddddd',padding:'5px 20px 10px 20px',borderBottom:'1px dotted black'}},React.createElement('div',{className:'row'},React.createElement('div',{className:'four columns'},React.createElement('label',{htmlFor:'num'},'\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0422\u0443\u0440.'),React.createElement('input',{type:'number',id:'num',className:'u-full-width'})),React.createElement('div',{className:'four columns'},React.createElement('label',{htmlFor:'cash'},'\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u0445'),React.createElement('input',{id:'cash',type:'number',className:'u-full-width'})),React.createElement('div',{className:'four columns'},React.createElement('label',{htmlFor:'source'},'\u0418\u0441\u0442\u043E\u0447\u043D\u0438\u043A'),React.createElement('select',{className:'u-full-width',id:'source'},m))),React.createElement('div',{className:'row'},React.createElement('div',{className:'eight columns'},React.createElement('label',{htmlFor:'notes'},'\u0414\u043E\u043F. \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F'),React.createElement('input',{type:'text',id:'notes',className:'u-full-width'})),React.createElement('div',{className:'four columns'},React.createElement('button',{className:'u-full-width button-primary',style:{marginTop:'30px'}},'\u0424\u043E\u0442\u043E \u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F')))),h,React.createElement('div',{className:'row',style:{marginTop:'20px'}},React.createElement('div',{className:'six columns'},React.createElement('button',{className:'u-full-width',onClick:this.addTour},'\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0422\u0443\u0440.')),React.createElement('div',{className:'six columns'},React.createElement('button',{className:'u-full-width button-primary'},'\u0424\u043E\u0442\u043E \u0413\u0440\u0443\u043F\u043F\u044B'))),React.createElement('div',{className:'row'},React.createElement('div',{className:'twelve columns'},React.createElement('button',{className:'u-full-width',onClick:this.props.changeScreenToRecords},'C\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C'))),React.createElement('div',{className:'row'},React.createElement('div',{className:'twelve columns'},React.createElement('button',{className:'u-full-width button-primary',onClick:this.props.changeScreenToRecords},'\u041E\u0442\u043C\u0435\u043D\u0430'))))}}]),d}(React.Component),Tour=function(c){function d(e){return _classCallCheck(this,d),_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e))}return _inherits(d,c),_createClass(d,[{key:'render',value:function render(){for(var e=[],f=0;f<DummyApi.companyList.length;f++)e[f]=React.createElement('option',{key:f,value:f},DummyApi.companyList[f]);return React.createElement('div',{style:{backgroundColor:'#dddddd',padding:'5px 20px 10px 20px',borderBottom:'1px dotted black'}},React.createElement('div',{className:'row'},React.createElement('div',{className:'four columns'},React.createElement('label',{htmlFor:'num'},'\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0422\u0443\u0440.'),React.createElement('input',{type:'number',id:'num',className:'u-full-width'})),React.createElement('div',{className:'four columns'},React.createElement('label',{htmlFor:'cash'},'\u041D\u0430\u043B\u0438\u0447\u043D\u044B\u0445'),React.createElement('input',{id:'cash',type:'number',className:'u-full-width'})),React.createElement('div',{className:'four columns'},React.createElement('label',{htmlFor:'source'},'\u0418\u0441\u0442\u043E\u0447\u043D\u0438\u043A'),React.createElement('select',{className:'u-full-width',id:'source'},e))),React.createElement('div',{className:'row'},React.createElement('div',{className:'eight columns'},React.createElement('label',{htmlFor:'notes'},'\u0414\u043E\u043F. \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F'),React.createElement('input',{type:'text',id:'notes',className:'u-full-width'})),React.createElement('div',{className:'four columns'},React.createElement('button',{className:'u-full-width button-primary',onClick:this.props.removeTour},'\u0424\u043E\u0442\u043E \u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F'),React.createElement('button',{className:'u-full-width',onClick:this.props.removeTour},'\u0423\u0434\u0430\u043B\u0438\u0442\u044C'))))}}]),d}(React.Component),Confirm=function(c){function d(e){return _classCallCheck(this,d),_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e))}return _inherits(d,c),_createClass(d,[{key:'render',value:function render(){return React.createElement('div',{style:{textAlign:'center'}},React.createElement('br',null),React.createElement('br',null),React.createElement('br',null),React.createElement('br',null),React.createElement('h3',null,this.props.message),React.createElement('br',null),React.createElement('button',{style:{marginRight:'20px'},onClick:this.props.changeScreenToRecords},'\u0414\u0410'),React.createElement('button',{className:'button-primary',onClick:this.props.changeScreenToRecords},'\u041D\u0415\u0422'))}}]),d}(React.Component),Menu=function(c){function d(e){_classCallCheck(this,d);var f=_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return f.changeMonth=f.changeMonth.bind(f),f.renderCSV=f.renderCSV.bind(f),f}return _inherits(d,c),_createClass(d,[{key:'changeMonth',value:function changeMonth(e){this.props.updateRecords(e.target.value)}},{key:'renderCSV',value:function renderCSV(){var f=this.props.records,g=[];g[0]=[],g[0]=['\u0414\u0430\u0442\u0430'].concat(DummyApi.companyList),f.sort(function(v,w){return v.Дата===w.Дата?0:v.Дата<w.Дата?-1:1});var h=DummyApi.companyList.length,m=getDaysInMonth(new Date().getMonth(),new Date().getFullYear()).length;console.log(f);for(var p=0;p<m;p++){g[p+1]=[],g[p+1][0]=p+1;for(var q=0;q<h;q++){g[p+1][q+1]=0;for(var r=0;r<f.length;r++)if(f[r].Дата.getDate()==g[p+1][0])for(var s=0;s<f[r].Туристы.length;s++)f[r].Туристы[s].Откуда==g[0][q+1]&&(g[p+1][q+1]=g[p+1][q+1]+f[r].Туристы[s].Количество)}}console.log(g);var u='data:text/csv;charset=utf-8,';g.forEach(function(v){var w=v.join(',');u+=w+'\r\n'});var n=encodeURI(u),o=document.createElement('a');o.setAttribute('href',n),o.setAttribute('download','my_data.csv'),document.body.appendChild(o),o.click()}},{key:'render',value:function render(){for(var e=DummyApi.last12Months(),f=0;f<e.length;f++)e[f]=e[f][1]==this.selectedMonth&&e[f][2]==this.selectedYear?React.createElement('option',{key:f,value:JSON.stringify({month:e[f][1],year:e[f][2]}),selected:'selected'},e[f][0]):React.createElement('option',{key:f,value:JSON.stringify({month:e[f][1],year:e[f][2]})},e[f][0]);return React.createElement('div',{className:'container',style:{marginTop:'20px',marginBottom:'20px'}},React.createElement('div',{className:'row'},React.createElement('div',{className:'twelve columns'},React.createElement('select',{onChange:this.changeMonth,className:'u-full-width',id:'months'},e))),React.createElement('div',{className:'row',style:{borderBottom:'1px solid black'}},React.createElement('div',{className:'six columns'},React.createElement('button',{className:'button-primary u-full-width',onClick:this.props.changeScreenToAdd},'\u041D\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u041E\u0442\u0447\u0435\u0442')),React.createElement('div',{className:'six columns'},React.createElement('button',{className:'u-full-width',onClick:this.renderCSV},'\u042D\u043A\u0441\u043F\u043E\u0440\u0442'))))}}]),d}(React.Component),Records=function(c){function d(e){_classCallCheck(this,d);var f=_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return f.sortByDate=f.sortByDate.bind(f),f}return _inherits(d,c),_createClass(d,[{key:'sortByDate',value:function sortByDate(){this.props.records.sort(function(f,g){return f.Дата===g.Дата?0:f.Дата>g.Дата?-1:1})}},{key:'render',value:function render(){this.sortByDate();for(var e=[],h=0;h<this.props.records.length;h++){for(var f=0,g=0,m=0;m<this.props.records[h].Туристы.length;m++)g+=this.props.records[h].Туристы[m].Нал,f+=this.props.records[h].Туристы[m].Количество;e[h]=React.createElement(Record,{fullRecord:this.props.records[h],key:h,changeScreenToView:this.props.changeScreenToView,changeScreenToConfirm:this.props.changeScreenToConfirm,Дата:parseDate(this.props.records[h].Дата),Экскурсовод:this.props.records[h].Экскурсовод,Количество:f,Нал:g})}return React.createElement('div',{className:'container'},e)}}]),d}(React.Component),Record=function(c){function d(e){_classCallCheck(this,d);var f=_possibleConstructorReturn(this,(d.__proto__||Object.getPrototypeOf(d)).call(this,e));return f.changeScreenToView=f.changeScreenToView.bind(f),f}return _inherits(d,c),_createClass(d,[{key:'changeScreenToView',value:function changeScreenToView(){this.props.changeScreenToView(this.props.fullRecord)}},{key:'render',value:function render(){return React.createElement('div',{className:'row',style:{borderBottom:'1px dotted black',marginTop:'20px'}},React.createElement('div',{className:'six columns',style:{marginTop:'8px',marginBottom:'8px'}},React.createElement('b',null,this.props.Дата),' ',this.props.Экскурсовод,' ',React.createElement('b',null,this.props.Количество,'\u0427\u0435\u043B.'),React.createElement('span',{className:'u-pull-right'},this.props.Нал,' \u20AC')),React.createElement('div',{className:'six columns'},React.createElement('button',{className:'button-primary',onClick:this.changeScreenToView},'\u0414\u043E\u043F. \u0418\u043D\u0444\u043E.'),React.createElement('span',{className:'u-pull-right'},React.createElement('button',{onClick:this.props.changeScreenToConfirm},'\u0423\u0434\u0430\u043B\u0438\u0442\u044C'))))}}]),d}(React.Component);ReactDOM.render(React.createElement(App,{selectedMonth:new Date().getMonth()+1,selectedYear:new Date().getFullYear()}),document.getElementById('app'));